
# stable  {#stable-intro}
```{r, include = FALSE}
library(pmtables)
library(tidyverse)
```


`stable()` is the name of the workhorse function that is used to turn 
data.frames into `TeX` tables. This chapter will introduce the `stable()` function and how to us it to create basic tables. 

To illustrate usage and features of `stable()`, we will use the `stdata`
data set that comes with pmtables


```{r}

data <- stdata()

head(data)
```

We can turn this data frame into a `TeX` table by passing it into `stable()`. 


```{r}
out <- stable(data)

head(out, n = 10)
```

Note that we have shown the raw latex code that is generated by `stable()`. That 
is to say: the output from `stable()` is a character vector of latex code 
for the table. Note also that this character vector has a special class 
associated with it: `stable`.  That means we can write functions that recognize
this character vector as output from `stable()` and we can have those functions
process the character vector in special ways.

We can render that table in `TeX` **in the current Rmarkdown document** by
passing the text to `st_asis()`. 

```{r}
out %>% st_asis()
```

Remember to only call `st_asis()` when you are rendering tables inline in an 
Rmd document.  If you are sending table code to a `TeX` report, then 
you will save them to a file and then include them into your report. 

The remaining sections of this chapter will show you how to modify and 
enhance this output in the more basic ways.  We will implement separate 
chapters for more complicated table manipulations. 


## Annotate with file names

pmtables can track and annotate your table with the filenames of the 
R code that generated the table (`r_file`) as well as the output file 
where you write the the table `.tex` code (`output_file)`. 

To have pmtables annotate your table with these file names, pass them 
in with the `r_file` and `output_file` arguments

```{r}
out <- stable(data, r_file = "tables.R", output_file = "tables.tex")
```

When we look at the rendered table, these names will show up as annotations
at the bottom of the table

```{r}
out %>% st_asis()
```

## Saving your stable

Saving your stable **can** be as easy as sending it into `writeLines()`

```{r}
writeLines(out, con = tempfile(tmpdir = '.',fileext = ".tex"))
```

But remember that we passed in the `output_file` argument to `stable()` 
and we can use that data to save the table code to the file we named 
in that argument. 

Note that our `stable` object has another attribute now called `stable_file`

```{r}
attributes(out)
```

This has the value that we passed in as `output_file`. To save our table 
to `stable_file`, we call `stable_save()`

```{r}
stable_save(out)
```

There is a `dir` argument to `stable_save()` that we can use to to select
the directory where the file will be saved

```{r}
stable_save(out, dir = tempdir())
```

And if you look at the default value for `dir` in `?stable_save`, you'll 
see that this is associated with an option called `pmtables.dir`;  you 
can set that option to your default output directory and your tables 
will be saved there untill you change that

```{r, eval=FALSE}
options(pmtables.dir = tempdir())

stable_save(out)
```

```{r, include = FALSE}
options(pmtables.dir = NULL)
```























